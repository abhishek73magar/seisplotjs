<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="utf-8" />
   <link rel="stylesheet" href="style.css">
   <title>Channel Choosers</title>
</head>
<body>

  <h3 id="sp-channel-code-input">Channel:</h3>
  <div>
    <label>Code: </label><sp-channel-code-input/>
  </div>
  <div>
    <label>List: </label><sp-channellist/>
  </div>
  <div>
    <h5>Output:</h5>
    <p id="output"></p>
  </div>

  <script type="module">
    import {components, fdsnstation, stationxml} from '../seisplotjs_3.0.0-alpha.4_standalone.mjs';

    const listInput = document.querySelector('sp-channellist');

    const outputArea = document.querySelector('#output');
    const codeInput = document.querySelector('sp-channel-code-input');
    function doUpdateCodes() {
      outputArea.textContent = `Codes: ${codeInput.network}_${codeInput.station}_${codeInput.location}_${codeInput.channel}`;
      const query = new fdsnstation.StationQuery();
      query.networkCode(codeInput.network);
      query.stationCode(codeInput.station);
      query.locationCode(codeInput.location);
      query.channelCode(codeInput.channel);
      query.queryChannels().then(netList => {
        listInput.setChannels(Array.from(stationxml.allChannels(netList)));
      })
    }
    codeInput.addEventListener("change", doUpdateCodes);
    listInput.addEventListener("change", () => {
      outputArea.textContent = ``;
      for (let chan of listInput.selectedChannels()) {
        outputArea.textContent += ` ${chan.codes()} ${chan.timeRange}`;
      }
    });
    doUpdateCodes();
  </script>
</body>
</html>
