<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset='utf-8'>
    <title>Earthquake Dataset View</title>
    <style>
      div#myseismograph {
        width: 99%;
        min-height: 90vh;
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
      }
      div[plottype="seismograph"] {
        width: 100%;
        height: 200px;
        grid-column: 1 / -1;
      }
      div[plottype="amp_spectra"] {
        height: 400px;
        width: 100%;
        grid-column: 1 / -1;
      }
      div[plottype="amp_spectra"] {
        height: 400px;
        width: 100%;
        grid-column: 1 / -1;
      }
      div[plottype="particlemotion"]:not(:empty) {
        height: 33vw;
        width: 100%;
      }
      div[plottype="map"] {
        height: 250px;
        width: 100%;
        grid-column: 1 / -1;
      }
      div[plottype="info"] {
        overflow: scroll;
        grid-column: 1 / -1;
      }
      td {
        background-color: #fff;
      }
      th {
        background-color: #fff;
      }
      #mousex {
        width: 155px;
      }
      #title {
        text-align: center;
      }
      .errormsg {
        color: red;
      }
      div.tools {
        display:none;
        grid-template-columns: 2fr 1fr;
      }
      span.toggletools :target {
        display:block;
      }
      input#show, input#hide {
          display:none;
      }

      .drop {
        cursor: pointer;
        display: block;
      }

      input[type="checkbox"].hidetools  {
       display: none; /* hide the checkboxes */
      }
      input +.hidetools +  div
      {
        display:none;
      }
      .hidetools:before {
        content:'▶';
        }
      :checked  + .hidetools:before {
        content:'▼';
        }
      input:checked + .hidetools + div{
        display:grid;
      }
      label.hidetools span {
        font-size: larger;
      }
      div.tools {
        background-color: whitesmoke;
      }
      div.toolsleft {
      }
      div.toolsright {
        width: 60%;
      }
      div.seisConfig {
        background-color: gainsboro ;
        margin-left: 15px;
      }
    </style>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
     integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
     crossorigin=""/>

    <!-- this stops flavicon loading -->
    <link rel="icon" href="data:;base64,iVBORw0KGgo=">
  </head>
  <body>
    <div id='message'></div>
    <h3>Earthquake view: <span id="title">seismographs</span></h3>

    <input id="_1" type="checkbox" class="hidetools"></input>
    <label class="hidetools" for="_1"><span> Tools:</span></label>
    <div class='tools'>
      <div class='toolsleft'>
        <div class="seisConfigHider">
          <input id="_2" type="checkbox" class="hidetools"></input>
          <label class="hidetools" for="_2"><span> Display Config:</span></label>
          <div class="seisConfig">
          </div>
        </div>
          <div class="infoTemplateHider">
            <input id="_3" type="checkbox" class="hidetools"></input>
            <label class="hidetools" for="_3"><span> Info Template:</span></label>
            <div class="infoTemplate">
              <textarea id="infoTemplateText" name="infoTemplate" rows="5" cols="33">
              </textarea>
            </div>
          </div>
        <div>
          <button id="refresh">Refresh</button>
          <button id="reprocess">Reprocess</button>
          <button id="saveZip">Save</button>
          <label for="loadZip">Load: </label>
          <input type="file" id="loadZip" name="loadZip" multiple />
        </div>
        <div>
          <button id="rmean">RMean</button>
          <button id="taper">Taper</button>
          <label for="taperwidth">Taper Width: </label>
          <input type="text" id="taperwidth" name="taperwidth" value="0.05"></input>
        </div>
        <div>
          <button id="lowpass">Lowpass</button>
          <button id="bandpass">Bandpass</button>
          <button id="highpass">Highpass</button>
          <label for="lowfreq">Low Freq: </label>
          <input type="text" id="lowfreq" name="lowfreq" value="1.0"></input>
          <label for="lowfreq">High Freq: </label>
          <input type="text" id="highfreq" name="highfreq" value=10.0></input>
        </div>
        <div>
          <label>Phases:</label>
          <input type="checkbox" id="phases" name="phases" checked>
          <label for="phases">Show Predicted Arrivals</label>
          <label for="phaseList">Phases: </label>
          <input type="text" id="phaseList" name="phaseList" value="P,S"></input>
          <button id="ttimeRecalc">Recalc</button>
        </div>
        <div>
          <label>Plot Type:</label>
          <span>
            <input type="radio" id="radio_info" name="plottype" value="info">
            <label for="info">Info</label>
          </span>
          <span>
            <input type="radio" id="radio_map" name="plottype" value="map">
            <label for="map">Map</label>
          </span>
          <span>
            <input type="radio" id="radio_seismograph" name="plottype" value="seismograph" checked>
            <label for="seismograph">Seismograph</label>
          </span>
          <span>
            <input type="radio" id="radio_particlemotion" name="plottype" value="particlemotion" >
            <label for="particlemotion">Particle Motion</label>
          </span>
          <span>
            <input type="radio" id="radio_spectra_log" name="plottype" value="amp_spectra?loglog=true" >
            <label for="spectra_log">Spectra (Log)</label>
          </span>
          <span>
            <input type="radio" id="radio_spectra_lin" name="plottype" value="amp_spectra?loglog=false" >
            <label for="spectra_lin">Spectra (Lin)</label>
          </span>
        </div>
        <div>
          <label>Organized: </label>
          <span>
            <input type="radio" id="radio_organize_individual" name="organizetype" value="individual" checked>
            <label for="radio_organize_individual">Individual</label>
          </span>
          <span>
            <input type="radio" id="radio_organize_overlay_bystation" name="organizetype" value="bystation" >
            <label for="radio_organize_bystation">Station</label>
          </span>
          <span>
            <input type="radio" id="radio_organize_overlay_bycomponent" name="organizetype" value="bycomponent" >
            <label for="radio_organize_bycomponent">Component</label>
          </span>
          <span>
            <input type="radio" id="radio_organize_overlay_all" name="organizetype" value="all" >
            <label for="radio_organize_overlay_all">Overlay All</label>
          </span>
        </div>
        <div>
          <label>Sort: </label>
          <span>
            <input type="radio" id="radio_sort_none" name="sorttype" value="none" checked>
            <label for="radio_organize_individual">None</label>
          </span>
          <span>
            <input type="radio" id="radio_sort_alphabetical" name="sorttype" value="alphabetical" >
            <label for="radio_organize_alphabetical">Alphabetical</label>
          </span>
          <span>
            <input type="radio" id="radio_sort_bydistance" name="sorttype" value="bydistance" >
            <label for="radio_organize_bydistance">Distance</label>
          </span>
          <span>
            <input type="radio" id="radio_sort_bybackazimuth" name="sorttype" value="bybackazimuth" >
            <label for="radio_organize_bybackazimuth">Back Azimuth</label>
          </span>
          <span>
            <input type="radio" id="radio_sort_byazimuth" name="sorttype" value="byazimuth" >
            <label for="radio_organize_byazimuth">Azimuth</label>
          </span>
        </div>
        <div>
          <input type="checkbox" id="linkx" name="linkx" checked>
          <label for="linkx">Link Time Axis</label>
          <input type="checkbox" id="linky" name="linky" checked>
          <label for="linky">Link Amp Axis</label>
          <input type="checkbox" id="doGain" name="doGain" checked>
          <label for="doGain">Gain</label>
        </div>
        <div id="station_checkbox">
          <label>Stations:</label>
        </div>
        <div id="band_checkbox">
          <label>Band:</label>
        </div>
        <div id="gain_checkbox">
          <label>Gain:</label>
        </div>
        <div id="orient_checkbox">
          <label>Orientation:</label>
        </div>
        <div id="quake_checkbox">
          <label>Earthquake:</label>
        </div>
        <div>
          <input id="mousex" name="mousex" readonly>
          <label for="mousex">X</label>
          <input id="mousey" name="mousey" readonly>
          <label for="mousey">Y</label>
        </div>
      </div>
      <div class='toolsright'>
        <div id="processChain">
          <h5>Process Chain</h5>
          <ul>
          </ul>
        </div>
      </div>
    </div>
    <div id="messages"></div>

    <div id="myseismograph">
    </div>

    <h5>Generated with <a href="https://github.com/crotwell/seisplotjs">Seisplotjs version <span id="version">2</span></a>.</h5>

    <script src="https://www.seis.sc.edu/downloads/seisplotjs/seisplotjs_2.1.0-alpha.0_standalone-xxx.js"></script>
    <script src="seisplotjs_2.1.0-alpha.0_standalone.js"></script>
    <script src="eqview.js"></script>
    <script src="tools.js"></script>
    <script>
      loadTestDataset().then(dataset => {
        // associate earthquakes with sdd waveforms
        dataset.associate();
        const viewObspy = new EQView(dataset);
        createTools(viewObspy);
        viewObspy.loadAllAndPlot();
      }).catch(err => {
        console.error(`problem load dataset: ${err}`);
        console.alert(false, err);
        const viewObspy = new EQView();
        createTools(viewObspy);
        viewObspy.loadAllAndPlot();
      });
    </script>
  </body>
</html>
